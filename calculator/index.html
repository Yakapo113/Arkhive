<div class="panel">
  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
    <strong>Assumptions & Inputs</strong>
    <span class="small muted">Edit defaults → press <strong>Run</strong></span>
  </div>

  <label>Current age</label>
  <input id="currentAge" type="number" min="50" max="95" value="62">

  <label style="margin-top:10px">Life expectancy (age)</label>
  <input id="lifeExpectancy" type="number" min="65" max="110" value="88">

  <label style="margin-top:10px">Health decline starting age (spendability reduces)</label>
  <input id="healthDeclineAge" type="number" min="60" max="110" value="80">

  <label style="margin-top:10px">Utility factor after decline (0-1). Example: 0.6 = 60% of prior spending utility</label>
  <input id="utilityAfterDecline" type="number" step="0.01" min="0" max="1" value="0.6">

  <label style="margin-top:10px">Other retirement assets — $</label>
  <input id="assets" type="text" value="500,000">
  <div class="small muted">Enter total assets. Commas are auto-formatted.</div>

  <div style="display:flex;gap:8px;margin-top:8px">
    <div style="flex:1">
      <label>Withdrawal rate if delaying SS (annual %)</label>
      <input id="withdrawRate" type="number" step="0.1" value="4.0">
    </div>
    <div style="flex:1">
      <label>Portfolio annual return (real %, after inflation)</label>
      <input id="realReturn" type="number" step="0.1" value="4.0">
    </div>
  </div>

  <div style="display:flex;gap:8px;margin-top:8px">
    <div style="flex:1">
      <label>Inflation rate (annual %)</label>
      <input id="inflation" type="number" step="0.1" value="2.0">
    </div>
    <div style="flex:1">
      <label>Effective marginal tax rate on SS income (%)</label>
      <input id="taxRate" type="number" step="0.1" value="12.0">
    </div>
  </div>

  <hr style="border:none;border-top:1px solid rgba(255,255,255,0.03);margin:12px 0">

  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
    <strong>Claiming strategies (monthly SS benefit)</strong>
    <span class="small muted">Enter your expected benefit at each claim age</span>
  </div>

  <div class="strategy">
    <div class="flex-between">
      <div style="flex:1">
        <label>Strategy A claim age: <span id="claimA_age_label">62</span></label>
        <input type="range" id="claimA_age" min="62" max="70" value="62">
      </div>
      <div style="width:46%">
        <label>Monthly SS @ that age ($)</label>
        <input id="claimA_amt" type="number" min="0" value="2000">
      </div>
    </div>
  </div>

  <div class="strategy">
    <div class="flex-between">
      <div style="flex:1">
        <label>Strategy B claim age: <span id="claimB_age_label">67</span></label>
        <input type="range" id="claimB_age" min="62" max="70" value="67">
      </div>
      <div style="width:46%">
        <label>Monthly SS @ that age ($)</label>
        <input id="claimB_amt" type="number" min="0" value="2860">
      </div>
    </div>
  </div>

  <div class="strategy">
    <div class="flex-between">
      <div style="flex:1">
        <label>Strategy C claim age: <span id="claimC_age_label">70</span></label>
        <input type="range" id="claimC_age" min="62" max="70" value="70">
      </div>
      <div style="width:46%">
        <label>Monthly SS @ that age ($)</label>
        <input id="claimC_amt" type="number" min="0" value="3540">
      </div>
    </div>
  </div>

  <div style="display:flex;gap:8px;margin-top:12px" class="controls">
    <button id="runBtn" class="btn">Run comparison</button>
    <button id="resetBtn" class="btn secondary" title="Reset to defaults">Reset</button>
  </div>

  <div style="margin-top:10px" class="small muted">
    Notes: Use your SSA statement to enter expected monthly benefits. You can <a href="https://www.ssa.gov/benefits/retirement/estimator.html" target="_blank" style="color:var(--accent)">check your personal estimate here</a>.  
    This model treats Social Security as fixed nominal amounts you enter for each claim age, applies taxes, simulates portfolio evolution, and adjusts spending utility after the health decline age.
  </div>
</div>

<script>
  // Slider live label updates + run on change
  const sliders = [
    {id:'claimA_age', label:'claimA_age_label'},
    {id:'claimB_age', label:'claimB_age_label'},
    {id:'claimC_age', label:'claimC_age_label'}
  ];
  sliders.forEach(s=>{
    const slider = document.getElementById(s.id);
    const label = document.getElementById(s.label);
    slider.addEventListener('input', ()=>{ label.textContent = slider.value; });
    slider.addEventListener('change', ()=>{ document.getElementById('runBtn').click(); });
  });

  // Assets input formatting with commas
  const assetsInput = document.getElementById('assets');
  assetsInput.addEventListener('input', (e)=>{
    let value = e.target.value.replace(/,/g,'');
    if(!isNaN(value) && value!==''){
      e.target.value = Number(value).toLocaleString();
    }
  });
</script>
